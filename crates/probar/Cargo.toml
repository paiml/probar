[package]
name = "probar"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
description = "Probar: Rust-native testing framework for WASM games"
license.workspace = true
repository.workspace = true
keywords = ["testing", "wasm", "games", "browser", "e2e"]
categories = ["development-tools::testing", "wasm"]

[features]
default = ["tui"]
# Enable real browser control (requires chromium)
browser = ["chromiumoxide", "tokio", "futures"]
# Enable WASM runtime for logic testing (Phase 1)
runtime = ["wasmtime", "async-trait"]
# Enable derive macros for type-safe selectors (Phase 4)
derive = ["probar-derive"]
# Enable TUI testing (not available on WASM due to crossterm)
tui = ["ratatui", "crossterm"]

[dependencies]
thiserror = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
image = { workspace = true }
base64 = { workspace = true }

# Media generation
gif = { workspace = true }
png = { workspace = true }
mp4 = { workspace = true }

# TUI testing (EDD compliance) - optional, not available on WASM
ratatui = { workspace = true, optional = true }
crossterm = { workspace = true, optional = true }
regex = { workspace = true }
sha2 = { workspace = true }
serde_yaml = { workspace = true }

# Watch mode and tracing (Phase 6)
notify = { workspace = true }
tracing = { workspace = true }
tracing-subscriber = { workspace = true }
uuid = { workspace = true }

# Optional CDP browser control
chromiumoxide = { workspace = true, optional = true }
tokio = { workspace = true, optional = true }
futures = { workspace = true, optional = true }

# Optional WASM runtime for logic testing (Phase 1)
wasmtime = { workspace = true, optional = true }
async-trait = { workspace = true, optional = true }

# Optional derive macros for type-safe selectors (Phase 4)
probar-derive = { workspace = true, optional = true }

[dev-dependencies]
tokio = { workspace = true }
async-trait = { workspace = true }
proptest = { workspace = true }
tempfile = { workspace = true }

[[example]]
name = "locator_demo"
path = "examples/locator_demo.rs"

[[example]]
name = "accessibility_demo"
path = "examples/accessibility_demo.rs"

[[example]]
name = "coverage_demo"
path = "examples/coverage_demo.rs"

[[example]]
name = "pong_simulation"
path = "examples/pong_simulation.rs"

[lints]
workspace = true
